var quform=function(e,t,n,a){"use strict";function r(e){s.get("#qfb-entry-label-set").find(".qfb-entry-label").removeClass("qfb-label-selected").each(function(){var n=t(this);e.find(".qfb-entry-label-indicator").each(function(){t(this).data("id")==n.data("label").id&&n.addClass("qfb-label-selected")})}),s.get("#qfb-entry-label-set").show(),b&&s.get("#qfb-entry-label-set").css("marginTop",-(s.get("#qfb-entry-label-set").height()/2))}var l,i=e.core,s=i.cache,o=t(document),b=!1;return l={init:function(){b=t("body").hasClass("quform_admin_page_entries_list"),s.get(".qfb-entry-label-indicators").click(function(e){e.stopPropagation();var n=t(this),a=n.parent();s.get("#qfb-entry-label-set").parent()[0]===a[0]?s.get("#qfb-entry-label-set").is(":visible")?s.get("#qfb-entry-label-set").hide():r(n):(a.append(s.get("#qfb-entry-label-set").hide()),r(n))}),o.on("click",function(){s.get("#qfb-entry-label-set").hide()}),s.get("#qfb-entry-label-set").click(function(e){e.stopPropagation()}),s.get("#qfb-entry-label-set").find(".qfb-entry-label").click(function(){l.setEntryLabel(t(this))})},setEntryLabel:function(e){e.toggleClass("qfb-label-selected");var r=e.data("label"),s=e.hasClass("qfb-label-selected"),o=e.closest("th, td"),b=o.find(".qfb-entry-label-indicators");if(s){if(r.color){var f=t('<span class="qfb-entry-label-indicator">').data("id",r.id).css("background-color",r.color);l.isColorTransparent(r.color)&&f.addClass("qfb-entry-label-indicator-transparent"),i.isNonEmptyString(r.name)&&f.attr("title",r.name),b.append(f),b.find(".qfb-entry-label-indicator:not(.qfb-entry-label-indicator-transparent)").length&&b.find(".qfb-entry-no-labels").hide()}}else b.find(".qfb-entry-label-indicator").filter(function(){return t(this).data("id")==r.id}).remove(),b.find(".qfb-entry-label-indicator:not(.qfb-entry-label-indicator-transparent)").length||b.find(".qfb-entry-no-labels").show();t.ajax({url:a.ajaxUrl,type:"POST",dataType:"json",data:{action:"quform_set_entry_labels",_ajax_nonce:n.setEntryLabelsNonce,entry_id:o.data("entry-id"),entry_label_id:r.id,adding:s}})},isColorTransparent:function(e){if(!i.isNonEmptyString(e))return!0;if("transparent"==e)return!0;var t=/rgba\((.+)\)/gi.exec(e);if(t){var n=t[1].split(",");return 4==n.length&&0===parseFloat(n[3])}return!1}},t(document).ready(l.init),e.entries=l,e}(quform,jQuery,quformEntriesL10n,quformCoreL10n);